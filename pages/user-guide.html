<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="author" content="Artem Bityutskiy" />
    <meta name="robots" content="index, follow"/>

    <meta property="og:title" content="User Guide"/>
    <meta property="og:url" content="../pages/user-guide.html"/>
    <meta property="og:site_name" content="Wult"/>
    <meta property="og:type" content="website"/>

    <link rel="canonical" href="../pages/user-guide.html" />

    <title>User Guide | Wult</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" />
    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" />

    <link rel="stylesheet" type="text/css" href="../theme/css/main.css" />

    <script type="text/javascript">var switchTo5x=true;</script>
    <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
    <script type="text/javascript">
        stLight.options({
            publisher: "",
            doNotHash: false,
            doNotCopy: false,
            hashAddressBar: false
        });
    </script>
</head>

<body id="index">
    <div class="row-fluid">
        <div class="span10 offset1">
            <header id="banner" >
                <h1>
                    <a href="../">Wult </a>
                </h1>
                <nav class="navbar">
                    <div class="navbar-inner">
                        <ul class="nav">
                            <li ><a href="/wult/index.html">Overview</a></li>
                            <li ><a href="/wult/pages/user-guide.html">User Guide</a></li>
                            <li ><a href="/wult/pages/ndl.html">Ndl</a></li>
                        </ul>

                    </div>
                </nav>
            </header><!-- /#banner -->
        </div>
    </div>

    <div class="row-fluid">
        <div class="span10 offset1">
            <div class="row-fluid">
        
<section  >    
    <h1 class="entry-title">User Guide</h1>
    
    <!-- -*- coding: utf-8 -*- -->
<!-- vim: ts=4 sw=4 tw=100 et ai si -->
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#installation" id="id1">1 Installation</a><ul>
<li><a class="reference internal" href="#configure-the-systems" id="id2">1.1 Configure the systems</a><ul>
<li><a class="reference internal" href="#passwordless-sut-login" id="id3">1.1.1 Passwordless SUT login</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install-dependencies" id="id4">1.2 Install dependencies</a><ul>
<li><a class="reference internal" href="#kernel-sources" id="id5">1.2.1 Kernel sources</a></li>
<li><a class="reference internal" href="#os-packages" id="id6">1.2.2 OS packages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install-wult" id="id7">1.3 Install wult</a></li>
<li><a class="reference internal" href="#deploy-wult-drivers" id="id8">1.4 Deploy wult drivers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#update" id="id9">2 Update</a></li>
</ul>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#id1">1 Installation</a></h2>
<p><em>Wult</em> is a Python 3 project, but it comes with kernel drivers. Therefore, the basic installation
sequence is:</p>
<ol class="arabic simple">
<li>Install <em>wult</em> using <em>pip</em> (standard Python project installation tool).</li>
<li>Install the drivers.</li>
</ol>
<p><strong>Important</strong>: <em>Wult</em> is a research and debug tool, it loads its own drivers and requires root
privileges. Do not use it on a production system, use it only in a lab environment.</p>
<p><em>Wult</em> installation procedure will vary a little bit depending on whether you prefer the local or
remote usage models (<a class="reference external" href="../index.html#usage-models">details here</a>). In the former case, you install <em>wult</em> on the
SUT (System Under Test). Rn the latter case you install it on the controller. The drivers are
deployed to the SUT. It is also OK to have both setups at the same time.</p>
<p>From now on assume the remote usage model. In case of local usage model the &quot;SUT&quot; and &quot;controller&quot;
are the same system. Here are the main installation steps.</p>
<ol class="arabic simple">
<li>Configure the systems (SUT and controller).</li>
<li>Install the dependencies on the SUT and the controller.</li>
<li>Install <em>wult</em> project using <em>pip</em> to the controller.</li>
<li>Deploy <em>wult</em> drivers to the SUT.</li>
</ol>
<div class="section" id="configure-the-systems">
<h3><a class="toc-backref" href="#id2">1.1 Configure the systems</a></h3>
<p>First of all, make sure you have root or '<em>sudo</em>' permissions on both the SUT and the controller.</p>
<div class="section" id="passwordless-sut-login">
<h4><a class="toc-backref" href="#id3">1.1.1 Passwordless SUT login</a></h4>
<p>This is only needed for the remote usage model. Skip this step in case of the local usage model</p>
<p>In case of the remote usage model, you need to configure passwordless root SSH login from the
controller to the SUT. You are going to run <em>wult</em> as a regular user on the controller, but it will
SSH into the SUT as 'root'. Please, use online documentation to find out how to do this for your
Linux distribution, but here is one way of doing this (worked on Fedora and Ubuntu).</p>
<p>Configure the SSH server on the SUT to allow for root login by enabling the &quot;PermitRootLogin&quot;
option. Then restart the SSH server.</p>
<pre class="literal-block">
sudo sh -c 'echo &quot;PermitRootLogin yes&quot; &gt;&gt; /etc/ssh/sshd_config'
sudo systemctl restart sshd
</pre>
<p>You'll need user SSH keys on the controller. If you do not have them, generate a new SSH key pair on
the controller. For example, this command (executed as under your user on the controller) will
generate a pair of RSA keys - &quot;sut&quot; (private key) and &quot;sut.pub&quot; (public key):</p>
<pre class="literal-block">
cd ~/.ssh
ssh-keygen -t rsa -f sut
</pre>
<p>And the last step is to configure the controller to use the &quot;~/.ssh/sut&quot; private key when
authenticating to the SUT. You can run something like this on the controller:</p>
<pre class="literal-block">
cat &lt;&lt;EOF &gt;&gt; ~/.ssh/config
Host SUTNAME
    IdentityFile ~/.ssh/sut
EOF
</pre>
<p>Now you should be able to log in to the SUT as root without typing the password. Test it by running
the following on the controller:</p>
<pre class="literal-block">
ssh root&#64;SUTNAME
</pre>
</div>
</div>
<div class="section" id="install-dependencies">
<h3><a class="toc-backref" href="#id4">1.2 Install dependencies</a></h3>
<p><em>Wult</em> has several dependencies. First of all, you'll need the sources of the running kernel sources
must be installed on the SUT. You'll also need the tools necessary for compiling kernel drivers on
the SUT: gcc, make, etc. The controller must have python version 3.6 or higher installed.</p>
<div class="section" id="kernel-sources">
<h4><a class="toc-backref" href="#id5">1.2.1 Kernel sources</a></h4>
<p><em>Wult</em> comes with kernel drivers which have to be built for the kernel running on the SUT. The
drivers are built on the SUT, therefore you should install kernel sources on the SUT. Note, just
user-space headers is not enough, you should install the actual kernel sources.</p>
<p>On Fedora and Ubuntu, the sources are typically located in &quot;/lib/modules/&lt;kernel_version&gt;/build&quot;.
The &quot;&lt;kernel_version&gt;&quot; part must match the kernel running on the SUT. In other words, it has to me
the same as what the &quot;uname -r&quot; command prints when you run it on the SUT.</p>
<p>Unless you are an advanced user, you probably run a stock OS kernel on the SUT. In this case, it is
enough to just install the kernel sources package provided by the OS, e.g.:
* Fedora: 'kernel-devel' package
* Ubuntu: 'linux-source' package</p>
<p>If you are an advanced user, you can provide the sources path to the 'wult deploy' command when you
actually build the kernel modules.</p>
</div>
<div class="section" id="os-packages">
<h4><a class="toc-backref" href="#id6">1.2.2 OS packages</a></h4>
<p>There are bunch of other packages that will be needed when using <em>wult</em>.</p>
<p><strong>Fedora</strong></p>
<p>Here are the packages that will be needed on the SUT (tested in Fedora 28-32).</p>
<pre class="literal-block">
sudo dnf install -y tar bison flex make gcc elfutils-libelf-devel rsync
sudo dnf install -y libffi-devel redhat-rpm-config openssl-devel
sudo dnf install -y kernel-devel
</pre>
<p>Here are the packages that will be needed on the controller.</p>
<pre class="literal-block">
sudo dnf install -y git python3 python3-devel python3-pip python3-numpy
sudo dnf install -y python3-colorama python3-yaml python3-pandas
sudo dnf install -y  python3-paramiko python3-jinja2 rsync
</pre>
<p><strong>Ubuntu</strong></p>
<p>Here are the packages that will be needed on the SUT.</p>
<pre class="literal-block">
sudo apt install -y bison flex libelf-dev libssl-dev
sudo apt-get source linux-source
</pre>
<p>Here are the packages that will be needed on the controller.</p>
<pre class="literal-block">
sudo apt install -y git python3-pip python3-numpy python3-plotly
sudo apt install -y python3-colorama python3-yaml python3-pandas
sudo apt install -y python3-paramiko python3-jinja2 rsync
</pre>
<p><strong>Notes</strong></p>
<ol class="arabic simple">
<li>If you do not install python projects like &quot;numpy&quot; by installing the corresponding &quot;python3-*&quot; OS
packages, they will be pulled by the &quot;pip&quot; tool later when you install <em>wult</em>.</li>
<li>The &quot;git&quot; package is required to make it possible installing <em>wult</em> python projects directly from
their git repository (see below). Otherwise it is not necessary.</li>
</ol>
</div>
</div>
<div class="section" id="install-wult">
<h3><a class="toc-backref" href="#id7">1.3 Install wult</a></h3>
<p><em>Wult</em> is written in python version 3 and the easiest way of installing it is by using the &quot;pip3&quot; tool.
Advanced users can chose any other way of using/installing python code, e.g., just clone the git
repositories and configure &quot;PYTHONPATH&quot;. But there will be more caveats in this case.</p>
<p>Here is how to install <em>wult</em> directly from the git repository using the &quot;pip3&quot; tool. To install to
your home directory, run:</p>
<pre class="literal-block">
pip3 install --user git+https://github.com/intel/wult.git&#64;release
</pre>
<p>To install to the system, run:</p>
<pre class="literal-block">
sudo -H pip3 install git+https://github.com/intel/wult.git&#64;release
</pre>
<p>This will install <em>wult</em> from the &quot;release&quot; branch of the git repository. The &quot;release&quot; branch
contains more stable code. To install the latest code, use the &quot;master&quot; branch instead.</p>
</div>
<div class="section" id="deploy-wult-drivers">
<h3><a class="toc-backref" href="#id8">1.4 Deploy wult drivers</a></h3>
<p>When you install <em>wult</em>, you will also install the sources of <em>wult</em> driver. The next, and final step
is to build and deploy these drivers to the SUT. Use the &quot;wult deploy&quot; command to do this.</p>
<p>In case of the local usage model, run the &quot;wult deploy&quot; command on the SUT as &quot;root&quot;.</p>
<pre class="literal-block">
sudo wult deploy
</pre>
<p>In case of the remote usage model, run the following command on the controller (as a user, no as
root).</p>
<pre class="literal-block">
wult deploy -H SUTNAME
</pre>
<p>If you configured passwordless SSH authentication correctly (see above), this command will SSH to
the SUT (network host name is 'SUTNAME'), copy <em>wult</em> driver sources from the controller to the SUT,
build them on the SUT, then deploy them to the SUT.</p>
<p>Please, check 'wult deploy -h' for advanced usage options.</p>
</div>
</div>
<div class="section" id="update">
<h2><a class="toc-backref" href="#id9">2 Update</a></h2>
<p>If you installed <em>wult</em> using the 'pip' tool, you can use 'pip' to update it as well.
Here is how to update <em>wult</em> in case you installed it to your home directory.</p>
<pre class="literal-block">
pip3 install --user --upgrade git+https://github.com/intel/wult.git&#64;release
</pre>
<p>And in case you installed it to the system.</p>
<pre class="literal-block">
sudo -H pip3 install --upgrade git+https://github.com/intel/wult.git&#64;release
</pre>
<p><strong>Important</strong>: you have to re-deploy wult drivers after the update.
<a class="reference external" href="../index.html#local-usage-model">Local usage model</a>:</p>
<pre class="literal-block">
sudo wult deploy
</pre>
<p><a class="reference external" href="../index.html#remote-usage-model">Remote usage model</a>:</p>
<pre class="literal-block">
wult deploy -H SUTNAME
</pre>
</div>

</section>
            </div>
        </div>
    </div>

    <footer id="site-footer">
        <div class="row-fluid">
            <div class="span10 offset1">
                <address>
                    <p>
                        This blog is proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                    </p>
                    <p>
                        <a href="http://github.com/jsliang/pelican-fresh/">Fresh</a> is a responsive theme designed by <a href="http://jsliang.com/">jsliang</a> and <a href="https://github.com/jsliang/pelican-fresh/graphs/contributors">contributors</a>.
                        Special thanks to <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a> and <a href="http://getbootstrap.com/">Twitter Bootstrap</a>.
                    </p>
                </address>
            </div>
        </div>
    </footer>

    <script src="//code.jquery.com/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>
</body>
</html>